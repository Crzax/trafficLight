C51 COMPILER V9.60.7.0   TIMER                                                             10/31/2024 12:54:51 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\Timer.obj
COMPILER INVOKED BY: D:\Developer\Keil_5\C51\BIN\C51.EXE Timer.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Lis
                    -tings\Timer.lst) OBJECT(.\Objects\Timer.obj)

line level    source

   1          /**************************************************
   2           * Author:       陈震雄
   3           * Date:         2024-10-29
   4           * Description:  与定时器有关
   5           **************************************************/
   6          
   7          
   8          #include <REGX52.H>
   9          
  10          /**
  11            * @brief  上电初始化，启动定时器0
  12            * @param  无
  13            * @retval 无
  14            */
  15          void Timer0Init(void)           //50毫秒@11.0592MHz
  16          {
  17   1              TMOD &= 0xF0;    // 清零定时器0的模式位
  18   1          TMOD |= 0x01;    // 设置定时器0为模式1（16位定时器）
  19   1          TL0 = 0x00;      // 设置定时器0低字节初值
  20   1          TH0 = 0x4C;      // 设置定时器0高字节初值
  21   1          TF0 = 0;         // 清除定时器0的溢出标志位
  22   1          TR0 = 1;         // 启动定时器0
  23   1          ET0 = 1;         // 使能定时器0中断
  24   1          EA = 1;          // 使能总中断
  25   1      }
  26          
  27          /**
  28            * @brief  上电初始化，启动定时器1
  29            * @param  无
  30            * @retval 无
  31            */
  32          void Timer1Init(void)           //500微秒@11.0592MHz
  33          {
  34   1              TMOD &= 0x0F;           //设置定时器1模式
  35   1              TMOD |= 0x10;           //设置定时器1模式
  36   1              TL1 = 0x66;             //设置定时初值
  37   1              TH1 = 0xEA;             //设置定时初值
  38   1              TF1 = 0;                //清除TF1标志
  39   1              TR1 = 1;                //定时器1开始计时
  40   1              ET1 = 1;         // 使能定时器0中断
  41   1          EA = 1;          // 使能总中断
  42   1      }
  43          
  44          /**
  45            * @brief  计时器中断处理函数模板
  46            * @param  无
  47            * @retval 无
  48            */
  49          //void Timer0_Routine() interrupt 1
  50          //{
  51          //      static unsigned int T0Count;
  52          //      TL0 = 0x00;             //设置定时初值
  53          //      TH0 = 0x4C;             //设置定时初值
  54          //      T0Count++;
C51 COMPILER V9.60.7.0   TIMER                                                             10/31/2024 12:54:51 PAGE 2   

  55          //      if (T0Count>=1000)
  56          //      {
  57          //              T0Count=0;
  58          //      }
  59          //}
  60          
  61          /**
  62            * @brief  计时器2初始化
  63            * @param  无
  64            * @retval 无
  65            */
  66          void Timer2_Init(void)
  67          {
  68   1              T2CON = 0;
  69   1              TL2 = 0;
  70   1              TH2 = 0;
  71   1              RCAP2L = 0;
  72   1              RCAP2H = 0;
  73   1              TR2 = 0;
  74   1              TF2 = 0;
  75   1      }
  76          
  77          /**
  78            * @brief  设置计时器2的起始值
  79            * @param  无
  80            * @retval 无
  81            */
  82          void Timer2_SetCounter(unsigned int Value)
  83          {
  84   1              TH2 = Value/256;
  85   1              TL2 = Value%256;
  86   1              RCAP2H= Value/256;
  87   1              RCAP2L= Value%256;
  88   1      }
  89          
  90          /**
  91            * @brief  获得计时器2的计时
  92            * @param  无
  93            * @retval 计时器2的计时结果
  94            */
  95          unsigned int Timer2_GetCounter(void)
  96          {
  97   1              return (TH2<<8)|TL2;
  98   1      }
  99          
 100          /**
 101            * @brief  启动/关闭计时器2
 102            * @param  unsigned char，1表示启动，0表示关闭
 103            * @retval 无
 104            */
 105          void Timer2_Run(unsigned char Flag) {
 106   1              TR2 = Flag;
 107   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     92    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.60.7.0   TIMER                                                             10/31/2024 12:54:51 PAGE 3   

   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
